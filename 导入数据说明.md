# 图书批量导入数据格式说明

本项目支持三种格式的图书批量导入：**CSV**、**TXT**、**EXCEL**

## 数据格式

所有格式的数据必须包含以下7列（按顺序）：

1. **isbn** - 图书ISBN号（必填）
2. **title** - 图书标题（必填）
3. **author** - 作者（必填）
4. **category** - 分类（必填）
5. **publisher** - 出版社（可选）
6. **description** - 图书描述（可选）
7. **totalCount** - 总数量（可选，默认为0）

## 文件格式要求

### CSV格式（.csv）
- 使用逗号分隔各列
- 第一行可以是表头（包含"isbn"关键字），系统会自动跳过
- 每行一条图书记录
- 示例文件：`示例导入数据_CSV.csv`

### TXT格式（.txt）
- 使用逗号分隔各列
- 第一行可以是表头（包含"isbn"关键字），系统会自动跳过
- 每行一条图书记录
- 示例文件：`示例导入数据_TXT.txt`

### EXCEL格式（.xlsx 或 .xls）
- 支持Excel 2007及以上版本（.xlsx）和旧版Excel（.xls）
- 第一行可以是表头（包含"isbn"关键字），系统会自动跳过
- 每个工作表的第一列会被读取
- 示例文件：`示例导入数据_EXCEL.xlsx`

## 数据示例

```
isbn,title,author,category,publisher,description,totalCount
978-7-111-12345-1,Java编程思想,Bruce Eckel,计算机,机械工业出版社,Java编程经典教材，深入浅出讲解Java语言特性和面向对象编程思想,10
978-7-115-23456-2,Effective Java,Joshua Bloch,计算机,人民邮电出版社,Java最佳实践指南，包含78条实用的编程建议,8
```

## 导入功能说明

1. **自动跳过表头**：如果第一行包含"isbn"关键字，系统会自动识别为表头并跳过
2. **智能更新**：如果ISBN已存在，系统会更新该图书的信息；如果不存在，则插入新记录
3. **数据验证**：系统会验证必填字段（isbn、title、author、category），缺失必填字段的记录会被跳过
4. **批量处理**：支持一次性导入多条记录
5. **结果反馈**：导入完成后会显示成功和失败的记录数量

## 使用步骤

1. 在管理员界面点击"批量导入"按钮
2. 选择要导入的文件（支持CSV/TXT/EXCEL格式）
3. 系统自动解析并导入数据
4. 查看导入结果，确认成功和失败的记录数

## 注意事项

- 确保ISBN号唯一，重复的ISBN会导致数据更新而不是新增
- 必填字段不能为空：isbn、title、author、category
- 总数量（totalCount）必须是数字，如果为空或无效，默认为0
- 建议在导入前备份数据库
- 大量数据导入可能需要一些时间，请耐心等待



